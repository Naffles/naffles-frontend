FROM node:18

ENV NODE_VERSION=18.*
ENV PARCEL_VERSION=2.7.0
ENV PORT=4001
ARG NODE_ENV=production
ARG NEXT_PUBLIC_ENVIRONMENT=mainnet
ARG NEXT_PUBLIC_BASE_URL=https://naffles-api-oyoeituzeq-ez.a.run.app
ARG NEXT_PUBLIC_L1NAFFLEDAIMONDADDRESS=0x5d23dFE21D547cf30eF4DA045003577bD1a74F59
ARG NEXT_PUBLIC_L2NAFFLEDAIMONDADDRESS=0xe1Ab3967D0274d0c9094264c5597b2496c15b9F7
ARG NEXT_PUBLIC_L2OPENENTRYTICKETDAIMONDADDRESS=0xa47A46Bb43d4C8fC51876dbb5191Ae63080431Ec
ARG NEXT_PUBLIC_L2PAIDTICKETDAIMONDADDRESS=0x64e04D34853Ff3f9C4bCeBE28166d37774B67b71
ARG NEXT_PUBLIC_ZKSYNCDAIMONDADDRESS=0x32400084c286cf3e17e7b677ea9583e60a000324
EXPOSE 4001

# Update and install system dependencies

# Create workdir
RUN mkdir -p naffles
WORKDIR /naffles

# Install package dependencies
COPY . .

RUN yarn install --legacy-peer-deps
RUN yarn next build

ENTRYPOINT ["yarn"]
CMD ["start"]
