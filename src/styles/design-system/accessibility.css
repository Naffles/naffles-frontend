/**
 * Global Accessibility Styles - WCAG 2.1 AA compliant CSS
 * 
 * This file contains global CSS rules that ensure accessibility compliance
 * across the entire application, including focus management, reduced motion,
 * high contrast support, and screen reader utilities.
 * 
 * Requirement: 44.12 - Ensure accessibility compliance
 */

/* =============================================================================
   FOCUS MANAGEMENT - Visible focus indicators for all interactive elements
   ============================================================================= */

/* Base focus styles for all focusable elements */
*:focus {
  outline: none;
}

/* Focus-visible styles (modern browsers) */
*:focus-visible {
  outline: 2px solid var(--focus-color, #0ea5e9);
  outline-offset: 2px;
  border-radius: 4px;
}

/* Focus styles for buttons */
button:focus-visible,
[role="button"]:focus-visible {
  box-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1), 0 0 0 3px rgb(14 165 233 / 0.2);
}

/* Focus styles for inputs */
input:focus-visible,
textarea:focus-visible,
select:focus-visible {
  border-color: #0ea5e9;
  box-shadow: 0 0 0 3px rgb(14 165 233 / 0.2);
}

/* Focus styles for links */
a:focus-visible {
  outline: 2px solid #0ea5e9;
  outline-offset: 2px;
  border-radius: 4px;
}

/* Focus styles for cards and interactive containers */
[role="button"]:focus-visible,
[tabindex]:focus-visible {
  box-shadow: 0 0 0 3px rgb(14 165 233 / 0.2);
}

/* High contrast focus indicators */
.high-contrast *:focus-visible {
  outline: 3px solid currentColor;
  outline-offset: 2px;
}

/* =============================================================================
   REDUCED MOTION - Respect user's motion preferences
   ============================================================================= */

/* Disable animations and transitions for users who prefer reduced motion */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
  
  /* Keep essential animations for loading states */
  [aria-live],
  [role="progressbar"],
  .loading-spinner {
    animation-duration: 1s !important;
  }
}

/* =============================================================================
   HIGH CONTRAST - Enhanced contrast for better visibility
   ============================================================================= */

/* High contrast mode styles */
@media (prefers-contrast: high) {
  :root {
    --text-primary: #000000;
    --text-secondary: #000000;
    --background: #ffffff;
    --border: #000000;
  }
  
  /* Increase border thickness */
  button,
  input,
  textarea,
  select,
  [role="button"] {
    border-width: 2px !important;
  }
  
  /* Enhance focus indicators */
  *:focus-visible {
    outline-width: 3px !important;
    outline-color: #000000 !important;
  }
}

/* Manual high contrast class */
.high-contrast {
  --text-primary: #000000;
  --text-secondary: #000000;
  --background: #ffffff;
  --border: #000000;
}

.high-contrast button,
.high-contrast input,
.high-contrast textarea,
.high-contrast select,
.high-contrast [role="button"] {
  border-width: 2px !important;
  border-color: #000000 !important;
}

.high-contrast *:focus-visible {
  outline-width: 3px !important;
  outline-color: #000000 !important;
}

/* =============================================================================
   SCREEN READER UTILITIES - Content for assistive technologies
   ============================================================================= */

/* Screen reader only content */
.sr-only {
  position: absolute !important;
  width: 1px !important;
  height: 1px !important;
  padding: 0 !important;
  margin: -1px !important;
  overflow: hidden !important;
  clip: rect(0, 0, 0, 0) !important;
  white-space: nowrap !important;
  border: 0 !important;
}

/* Screen reader only content that becomes visible on focus */
.sr-only-focusable:focus {
  position: static !important;
  width: auto !important;
  height: auto !important;
  padding: 0.5rem !important;
  margin: 0 !important;
  overflow: visible !important;
  clip: auto !important;
  white-space: normal !important;
  border: 2px solid #0ea5e9 !important;
  background-color: #ffffff !important;
  color: #111827 !important;
  text-decoration: none !important;
  z-index: 9999 !important;
}

/* Skip links */
.skip-link {
  position: absolute;
  top: 1rem;
  left: 1rem;
  z-index: 9999;
  padding: 0.5rem 1rem;
  background-color: #0ea5e9;
  color: #ffffff;
  text-decoration: none;
  border-radius: 0.375rem;
  font-weight: 500;
  transform: translateY(-100%);
  transition: transform 0.2s ease;
}

.skip-link:focus {
  transform: translateY(0);
}

/* =============================================================================
   KEYBOARD NAVIGATION - Enhanced keyboard interaction support
   ============================================================================= */

/* Show focus indicators when navigating with keyboard */
.focus-visible *:focus:not(:focus-visible) {
  outline: none;
  box-shadow: none;
}

/* Enhanced tab order visibility */
body.keyboard-navigation *:focus {
  outline: 2px solid #0ea5e9 !important;
  outline-offset: 2px !important;
}

/* =============================================================================
   TOUCH TARGET SIZES - Minimum 44px touch targets
   ============================================================================= */

/* Ensure minimum touch target size for interactive elements */
button,
input,
textarea,
select,
a,
[role="button"],
[role="tab"],
[role="menuitem"],
[tabindex] {
  min-height: 44px;
  min-width: 44px;
}

/* Exception for inline elements */
a:not([role="button"]) {
  min-height: auto;
  min-width: auto;
}

/* Small interactive elements should still meet minimum size */
input[type="checkbox"],
input[type="radio"] {
  min-height: 16px;
  min-width: 16px;
  /* Ensure clickable area is still 44px */
  padding: 14px;
  margin: -14px;
}

/* =============================================================================
   COLOR AND CONTRAST - Ensure sufficient color contrast
   ============================================================================= */

/* Ensure text meets contrast requirements */
:root {
  --text-primary: #111827; /* 16.94:1 contrast on white */
  --text-secondary: #6b7280; /* 4.69:1 contrast on white */
  --text-tertiary: #9ca3af; /* 3.28:1 contrast on white - large text only */
  --text-inverse: #ffffff; /* 21:1 contrast on dark backgrounds */
  
  --background-primary: #ffffff;
  --background-secondary: #f9fafb;
  --background-tertiary: #f3f4f6;
  
  --border-primary: #e5e7eb; /* 3.06:1 contrast - UI elements */
  --border-secondary: #d1d5db; /* 3.84:1 contrast */
  --border-focus: #0ea5e9; /* 3.26:1 contrast on white */
  
  --error-text: #dc2626; /* 5.93:1 contrast on white */
  --error-background: #fef2f2; /* Light error background */
  --success-text: #16a34a; /* 4.54:1 contrast on white */
  --success-background: #f0fdf4; /* Light success background */
  --warning-text: #d97706; /* 4.51:1 contrast on white */
  --warning-background: #fffbeb; /* Light warning background */
}

/* Dark theme color adjustments */
@media (prefers-color-scheme: dark) {
  :root {
    --text-primary: #f9fafb; /* High contrast on dark */
    --text-secondary: #d1d5db; /* Good contrast on dark */
    --text-tertiary: #9ca3af; /* Adequate contrast on dark */
    --text-inverse: #111827; /* High contrast on light */
    
    --background-primary: #111827;
    --background-secondary: #1f2937;
    --background-tertiary: #374151;
    
    --border-primary: #374151;
    --border-secondary: #4b5563;
    --border-focus: #60a5fa; /* Lighter blue for dark backgrounds */
  }
}

/* Manual dark theme */
[data-color-scheme="dark"] {
  --text-primary: #f9fafb;
  --text-secondary: #d1d5db;
  --text-tertiary: #9ca3af;
  --text-inverse: #111827;
  
  --background-primary: #111827;
  --background-secondary: #1f2937;
  --background-tertiary: #374151;
  
  --border-primary: #374151;
  --border-secondary: #4b5563;
  --border-focus: #60a5fa;
}

/* =============================================================================
   RESPONSIVE TEXT SCALING - Respect user font size preferences
   ============================================================================= */

/* Base font size that scales with user preferences */
html {
  font-size: 16px; /* Base size */
}

/* Responsive text scaling using clamp() */
.text-xs { font-size: clamp(0.75rem, 0.7rem + 0.25vw, 0.875rem); }
.text-sm { font-size: clamp(0.875rem, 0.8rem + 0.375vw, 1rem); }
.text-base { font-size: clamp(1rem, 0.9rem + 0.5vw, 1.125rem); }
.text-lg { font-size: clamp(1.125rem, 1rem + 0.625vw, 1.25rem); }
.text-xl { font-size: clamp(1.25rem, 1.1rem + 0.75vw, 1.5rem); }
.text-2xl { font-size: clamp(1.5rem, 1.3rem + 1vw, 1.875rem); }
.text-3xl { font-size: clamp(1.875rem, 1.6rem + 1.375vw, 2.25rem); }
.text-4xl { font-size: clamp(2.25rem, 1.9rem + 1.75vw, 3rem); }

/* =============================================================================
   SEMANTIC HTML ENHANCEMENTS - Improve semantic meaning
   ============================================================================= */

/* Enhance semantic elements */
main {
  display: block;
}

/* Ensure headings have proper hierarchy */
h1, h2, h3, h4, h5, h6 {
  font-weight: 600;
  line-height: 1.25;
  margin-bottom: 0.5em;
}

h1 { font-size: 2.25rem; }
h2 { font-size: 1.875rem; }
h3 { font-size: 1.5rem; }
h4 { font-size: 1.25rem; }
h5 { font-size: 1.125rem; }
h6 { font-size: 1rem; }

/* Improve list accessibility */
ul, ol {
  padding-left: 1.5rem;
}

li {
  margin-bottom: 0.25rem;
}

/* Improve table accessibility */
table {
  border-collapse: collapse;
  width: 100%;
}

th, td {
  text-align: left;
  padding: 0.75rem;
  border-bottom: 1px solid var(--border-primary);
}

th {
  font-weight: 600;
  background-color: var(--background-secondary);
}

/* Improve form accessibility */
label {
  display: block;
  font-weight: 500;
  margin-bottom: 0.25rem;
  color: var(--text-primary);
}

input, textarea, select {
  font-family: inherit;
  font-size: inherit;
  line-height: inherit;
}

/* Required field indicators */
.required::after {
  content: " *";
  color: var(--error-text);
}

/* =============================================================================
   ERROR AND SUCCESS STATES - Clear visual feedback
   ============================================================================= */

/* Error states */
.error,
[aria-invalid="true"] {
  border-color: var(--error-text) !important;
  color: var(--error-text);
}

.error-message {
  color: var(--error-text);
  font-size: 0.875rem;
  margin-top: 0.25rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;
}

/* Success states */
.success {
  border-color: var(--success-text) !important;
  color: var(--success-text);
}

.success-message {
  color: var(--success-text);
  font-size: 0.875rem;
  margin-top: 0.25rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;
}

/* Warning states */
.warning {
  border-color: var(--warning-text) !important;
  color: var(--warning-text);
}

.warning-message {
  color: var(--warning-text);
  font-size: 0.875rem;
  margin-top: 0.25rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;
}

/* =============================================================================
   LOADING AND PROGRESS INDICATORS - Accessible loading states
   ============================================================================= */

/* Loading spinner */
.loading-spinner {
  width: 1.5rem;
  height: 1.5rem;
  border: 2px solid transparent;
  border-top: 2px solid currentColor;
  border-radius: 50%;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

/* Progress bars */
[role="progressbar"] {
  background-color: var(--background-tertiary);
  border-radius: 0.25rem;
  overflow: hidden;
  height: 0.5rem;
}

[role="progressbar"]::before {
  content: '';
  display: block;
  height: 100%;
  background-color: var(--border-focus);
  width: var(--progress-value, 0%);
  transition: width 0.3s ease;
}

/* =============================================================================
   PRINT STYLES - Ensure accessibility in print
   ============================================================================= */

@media print {
  /* Ensure sufficient contrast in print */
  * {
    color: #000000 !important;
    background: #ffffff !important;
  }
  
  /* Show URLs for links */
  a[href]::after {
    content: " (" attr(href) ")";
    font-size: 0.8em;
    color: #666666;
  }
  
  /* Hide interactive elements that don't work in print */
  button,
  input,
  textarea,
  select,
  [role="button"] {
    display: none !important;
  }
  
  /* Ensure page breaks don't break content */
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  
  p, li {
    page-break-inside: avoid;
  }
}

/* =============================================================================
   UTILITY CLASSES - Common accessibility utilities
   ============================================================================= */

/* Visually hidden but available to screen readers */
.visually-hidden {
  position: absolute !important;
  width: 1px !important;
  height: 1px !important;
  padding: 0 !important;
  margin: -1px !important;
  overflow: hidden !important;
  clip: rect(0, 0, 0, 0) !important;
  white-space: nowrap !important;
  border: 0 !important;
}

/* Remove from accessibility tree */
.aria-hidden {
  aria-hidden: true;
}

/* Ensure element is focusable */
.focusable {
  tabindex: 0;
}

/* Remove from tab order */
.not-focusable {
  tabindex: -1;
}

/* High contrast border utility */
.high-contrast-border {
  border: 2px solid currentColor !important;
}

/* Focus trap container */
.focus-trap {
  isolation: isolate;
}

/* Announcement region */
.announcement-region {
  position: absolute;
  left: -10000px;
  width: 1px;
  height: 1px;
  overflow: hidden;
}